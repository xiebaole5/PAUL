# 微信小程序发布完整指南

## 📋 发布前的准备工作

### 1. 注册微信小程序账号

1. 访问 [微信公众平台](https://mp.weixin.qq.com/)
2. 点击 **"立即注册"** → 选择 **"小程序"**
3. 填写账号信息：
   - 邮箱：未注册过微信的邮箱
   - 密码：设置登录密码
   - 确认密码：再次输入密码
4. 激活邮箱：
   - 登录邮箱，点击激活链接
   - 完成邮箱验证
5. 选择主体类型：
   - **个人**：适合个人开发者，功能受限
   - **企业**：适合公司，功能完整（推荐）
6. 完善主体信息：
   - 个人：填写身份证信息
   - 企业：上传营业执照、填写企业信息
7. 选择小程序类目：
   - 工具类、电商类、服务类等
8. 填写小程序名称：
   - 名称需要唯一，不能与已注册的小程序重复
   - 建议命名：**天虹紧固件视频生成**

### 2. 获取 AppID

1. 登录 [微信公众平台](https://mp.weixin.qq.com/)
2. 进入 **"设置"** → **"开发设置"**
3. 复制 **AppID（小程序ID）**
4. 示例：`wx1234567890abcdef`

### 3. 配置服务器域名

**重要**：如果后端服务已经部署到生产环境，需要配置服务器域名

1. 进入 **"开发"** → **"开发管理"** → **"开发设置"**
2. 找到 **"服务器域名"**
3. 配置以下域名（如果你的后端已经部署）：
   - **request 合法域名**: `https://your-domain.com`
   - **uploadFile 合法域名**: `https://your-domain.com`
   - **downloadFile 合法域名**: `https://your-domain.com`

**注意**：
- 域名必须使用 HTTPS
- 需要备案（如果使用中国大陆服务器）
- 每个域名只允许配置最多 20 个

### 4. 配置业务域名（可选）

如果小程序需要访问网页（web-view），需要配置业务域名：
1. 进入 **"开发"** → **"开发管理"** → **"业务域名"**
2. 添加你的业务域名
3. 下载校验文件，上传到你的服务器根目录

---

## 🚀 发布流程

### 第一步：代码上传

#### 1. 在微信开发者工具中配置 AppID

1. 打开微信开发者工具
2. 点击右上角 **"详情"**
3. 在 **"基本信息"** 中，修改 **AppID**
4. 粘贴你的小程序 AppID
5. 重新编译项目

#### 2. 检查代码版本

1. 点击工具栏 **"版本管理"**
2. 查看 **"开发版本"**
3. 确认代码是最新的

#### 3. 上传代码

1. 点击工具栏 **"上传"** 按钮
2. 填写版本号：
   - 版本号：`1.0.0`（第一次发布）
   - 项目备注：`首次发布天虹紧固件视频生成小程序`
3. 点击 **"上传"**

上传成功后，会显示：
```
✓ 代码上传成功
```

### 第二步：提交审核

#### 1. 进入微信公众平台

1. 登录 [微信公众平台](https://mp.weixin.qq.com/)
2. 进入 **"版本管理"** → **"开发版本"**

#### 2. 选定为体验版（可选）

1. 找到刚才上传的版本
2. 点击右侧 **"..."** → **"选为体验版"**
3. 生成体验版二维码
4. 可以分享给内部人员测试

#### 3. 提交审核

1. 点击 **"提交审核"** 按钮
2. 填写审核信息：

**基本信息**：
- 版本号：`1.0.0`
- 版本描述：`天虹紧固件视频生成功能上线，支持AI生成广告视频`

**功能页面**：
- 添加功能页面：首页 - 视频生成
- 页面路径：`pages/index/index`
- 功能说明：`用户填写产品信息，生成20秒广告视频`

**测试账号**（可选）：
- 如果小程序需要登录，提供测试账号
- 本项目不需要登录，可跳过

**服务类目**：
- 选择：工具 > 工具 > 其他工具
- 或选择：IT科技 > 软件服务 > 开发工具

**审核标签**：
- 添加标签：AI工具、视频生成、广告制作

3. 检查隐私协议：
   - 进入 **"设置"** → **"基本设置"** → **"服务内容"**
   - 填写 **"用户隐私保护指引"**
   - 说明小程序收集的用户信息和用途

4. 提交审核

### 第三步：等待审核

**审核时间**：
- 个人小程序：1-3 个工作日
- 企业小程序：1-7 个工作日

**审核内容**：
- 代码质量
- 内容合规性
- 功能完整性
- 用户体验

**审核状态查询**：
1. 进入 **"版本管理"** → **"审核版本"**
2. 查看审核状态：
   - **审核中**：正在审核
   - **审核通过**：可以发布
   - **审核不通过**：查看原因，修改后重新提交

### 第四步：发布上线

#### 1. 审核通过后发布

1. 进入 **"版本管理"** → **"审核版本"**
2. 找到审核通过的版本
3. 点击 **"发布"** 按钮
4. 确认发布信息：
   - 版本号：`1.0.0`
   - 发布说明：`天虹紧固件视频生成小程序正式上线`
5. 点击 **"确定发布"**

#### 2. 发布成功

发布成功后，小程序会在 24 小时内全网生效。

---

## 📱 发布后的操作

### 1. 查看小程序

1. 在微信中搜索你的小程序名称
2. 扫描小程序码
3. 通过微信分享链接访问

### 2. 查看数据分析

1. 进入微信公众平台
2. 点击 **"统计"** → **"数据分析"**
3. 查看数据：
   - 用户访问数
   - 页面访问量
   - 留存率
   - 分享数据

### 3. 版本更新

#### 更新流程：

1. 修改代码
2. 在微信开发者工具中上传新版本
3. 版本号改为 `1.0.1` 或 `1.1.0`
4. 提交审核
5. 审核通过后发布

#### 版本号规范：

- **主版本号**：重大更新（`1.0.0` → `2.0.0`）
- **次版本号**：新功能添加（`1.0.0` → `1.1.0`）
- **修订版本号**：Bug修复（`1.0.0` → `1.0.1`）

---

## ⚠️ 常见问题

### 1. 审核不通过怎么办？

**常见原因**：
- 内容违规（涉黄、涉政、虚假宣传等）
- 功能不完整
- UI/UX 不符合规范
- 隐私协议未填写
- 服务器域名未配置

**解决方法**：
1. 查看审核不通过的原因
2. 修改代码或补充信息
3. 重新提交审核

### 2. 个人小程序 vs 企业小程序

| 功能 | 个人小程序 | 企业小程序 |
|------|-----------|-----------|
| 微信支付 | ❌ 不支持 | ✅ 支持 |
| 获取用户手机号 | ❌ 不支持 | ✅ 支持 |
| 接口权限 | 有限 | 完整 |
| 审核时间 | 1-3天 | 1-7天 |
| 功能类目 | 受限 | 完整 |

### 3. 如何配置后端服务器域名？

**步骤**：
1. 购买云服务器（阿里云、腾讯云等）
2. 安装 Python 和 FastAPI
3. 配置 Nginx 反向代理
4. 申请 SSL 证书（免费或付费）
5. 在微信公众平台配置服务器域名

**参考文档**：`docs/微信小程序部署指南.md`

### 4. 体验版和正式版的区别？

| 特性 | 体验版 | 正式版 |
|------|--------|--------|
| 访问范围 | 仅扫码访问 | 全网公开 |
| 用户数量 | 有限制（100人） | 无限制 |
| 功能完整度 | 完整 | 完整 |
| 需要审核 | 不需要 | 需要 |

### 5. 如何获取小程序码？

1. 进入微信公众平台
2. 点击 **"设置"** → **"基本设置"**
3. 找到 **"小程序码"**
4. 下载不同尺寸的小程序码

---

## 📝 发布检查清单

### 发布前检查

- [ ] AppID 已正确配置
- [ ] 代码已测试通过
- [ ] 所有功能正常运行
- [ ] 后端服务已部署（如需要）
- [ ] 服务器域名已配置（如需要）
- [ ] 隐私协议已填写
- [ ] 小程序图标已上传
- [ ] 小程序名称已确认

### 审核前检查

- [ ] 功能页面已添加
- [ ] 服务类目已选择
- [ ] 测试账号已提供（如需要）
- [ ] 审核标签已添加
- [ ] 版本描述已填写

### 发布后检查

- [ ] 小程序可正常访问
- [ ] 所有功能正常运行
- [ ] 数据统计正常显示
- [ ] 用户反馈正常

---

## 🎯 本项目发布步骤总结

### 第一次发布

```bash
# 1. 在微信开发者工具中配置 AppID
# 2. 上传代码
版本号: 1.0.0
备注: 天虹紧固件视频生成小程序首次发布

# 3. 提交审核
功能页面: 首页 - 视频生成 (pages/index/index)
服务类目: 工具 > 工具 > 其他工具
审核标签: AI工具、视频生成、广告制作

# 4. 等待审核通过（1-3天）

# 5. 发布上线
```

### 后续更新

```bash
# 1. 修改代码
# 2. 上传新版本
版本号: 1.0.1（Bug修复）
备注: 修复视频生成失败的问题

# 3. 提交审核

# 4. 发布上线
```

---

## 📚 相关资源

- [微信小程序官方文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [微信公众平台](https://mp.weixin.qq.com/)
- [微信开发者工具下载](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
- [小程序审核规范](https://developers.weixin.qq.com/miniprogram/product/reference/audit_guidelines.html)
- [小程序运营规范](https://developers.weixin.qq.com/miniprogram/product/operation_rules.html)

---

## 💡 建议

1. **先发布体验版**：发布前先发布体验版，邀请内部人员测试
2. **仔细填写审核信息**：审核信息越详细，审核通过率越高
3. **及时更新隐私协议**：如需收集用户信息，必须在隐私协议中说明
4. **关注审核进度**：及时查看审核状态，如有问题及时修改
5. **收集用户反馈**：发布后积极收集用户反馈，持续优化产品

---

**祝你发布顺利！** 🎉
