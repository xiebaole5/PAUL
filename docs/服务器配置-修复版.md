# æœåŠ¡å™¨é…ç½® - ä¿®å¤ç‰ˆï¼ˆæŒ‰é¡ºåºæ‰§è¡Œï¼‰

## âš ï¸ é‡è¦ï¼šå¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰æ­¥éª¤ï¼

---

## æ­¥éª¤1ï¼šå®‰è£…Nginxï¼ˆå¦‚æœå·²å®‰è£…å¯è·³è¿‡ï¼‰

```bash
sudo apt update
sudo apt install nginx -y
```

---

## æ­¥éª¤2ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶ï¼ˆå¿…é¡»æ‰§è¡Œï¼‰

```bash
sudo nano /etc/nginx/sites-available/tnho-fasteners.com
```

**å¤åˆ¶ä»¥ä¸‹æ‰€æœ‰å†…å®¹åˆ°æ–‡ä»¶ä¸­**ï¼ˆæŒ‰Ctrl+Vç²˜è´´ï¼‰ï¼š

```
server {
    listen 80;
    server_name tnho-fasteners.com;

    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }

    location / {
        return 301 https://$server_name$request_uri;
    }
}

server {
    listen 443 ssl http2;
    server_name tnho-fasteners.com;

    ssl_certificate /etc/letsencrypt/live/tnho-fasteners.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/tnho-fasteners.com/privkey.pem;

    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;

    client_max_body_size 10M;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /assets/ {
        alias /app/assets/;
        expires 7d;
    }
}
```

**ä¿å­˜æ–‡ä»¶**ï¼š
1. æŒ‰ `Ctrl+O`
2. æŒ‰ `Enter`
3. æŒ‰ `Ctrl+X`

**éªŒè¯æ–‡ä»¶å·²åˆ›å»º**ï¼š

```bash
ls -la /etc/nginx/sites-available/tnho-fasteners.com
```

åº”è¯¥æ˜¾ç¤ºæ–‡ä»¶å­˜åœ¨ã€‚

---

## æ­¥éª¤3ï¼šå¯ç”¨é…ç½®

```bash
sudo ln -sf /etc/nginx/sites-available/tnho-fasteners.com /etc/nginx/sites-enabled/
```

å¦‚æœå‡ºç°"File exists"æç¤ºï¼Œå¿½ç•¥å³å¯ã€‚

**åˆ é™¤é»˜è®¤é…ç½®ï¼ˆå¦‚æœå­˜åœ¨ï¼‰**ï¼š

```bash
sudo rm -f /etc/nginx/sites-enabled/default
```

---

## æ­¥éª¤4ï¼šåˆ›å»ºç›®å½•

```bash
sudo mkdir -p /var/www/certbot
sudo chown -R www-data:www-data /var/www/certbot
```

---

## æ­¥éª¤5ï¼šæµ‹è¯•é…ç½®

```bash
sudo nginx -t
```

**æˆåŠŸåº”è¯¥æ˜¾ç¤º**ï¼š
```
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
```

**å¦‚æœå¤±è´¥**ï¼ŒæŸ¥çœ‹è¯¦ç»†é”™è¯¯ï¼š
```bash
sudo nginx -t
```

---

## æ­¥éª¤6ï¼šå¯åŠ¨Nginx

```bash
sudo systemctl restart nginx
```

---

## æ­¥éª¤7ï¼šè®¾ç½®å¼€æœºè‡ªå¯

```bash
sudo systemctl enable nginx
```

---

## æ­¥éª¤8ï¼šæ£€æŸ¥NginxçŠ¶æ€

```bash
sudo systemctl status nginx
```

**æˆåŠŸåº”è¯¥æ˜¾ç¤º**ï¼š
```
Active: active (running)
```

---

## æ­¥éª¤9ï¼šæµ‹è¯•HTTPSè®¿é—®

```bash
curl https://tnho-fasteners.com/health
```

**æˆåŠŸåº”è¯¥è¿”å›**ï¼š
```json
{"status":"ok"}
```

---

## âœ… é…ç½®å®Œæˆï¼

å¦‚æœæ‰€æœ‰æ­¥éª¤éƒ½æˆåŠŸï¼Œé…ç½®å°±å®Œæˆäº†ï¼

---

## âŒ é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šnginx -t æµ‹è¯•å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
sudo nginx -t

# æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la /etc/nginx/sites-available/tnho-fasteners.com

# æ£€æŸ¥è¯ä¹¦æ˜¯å¦å­˜åœ¨
ls -la /etc/letsencrypt/live/tnho-fasteners.com/
```

**å¸¸è§é”™è¯¯**ï¼š
- `No such file or directory`ï¼šé…ç½®æ–‡ä»¶æœªåˆ›å»ºï¼Œè¿”å›æ­¥éª¤2
- `Permission denied`ï¼šæ£€æŸ¥sudoæƒé™
- `invalid host in upstream`ï¼šæ£€æŸ¥proxy_passåœ°å€

### é—®é¢˜2ï¼šHTTPSè®¿é—®å¤±è´¥

```bash
# æµ‹è¯•ç›´æ¥è®¿é—®æœåŠ¡å™¨
curl -kI https://47.110.72.148/health

# æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿è¡Œ
ps aux | grep "python app.py"

# æŸ¥çœ‹Nginxæ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

### é—®é¢˜3ï¼šNginxå¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
sudo journalctl -xeu nginx.service

# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep -E ":80|:443"

# æ£€æŸ¥é…ç½®æ–‡ä»¶
sudo cat /etc/nginx/sites-enabled/tnho-fasteners.com
```

---

## ğŸ“‹ å®Œæ•´æ£€æŸ¥æ¸…å•

é…ç½®å®Œæˆåï¼Œæ£€æŸ¥ä»¥ä¸‹é¡¹ç›®ï¼š

- [ ] Nginxå·²å®‰è£…
- [ ] é…ç½®æ–‡ä»¶å·²åˆ›å»ºï¼š`/etc/nginx/sites-available/tnho-fasteners.com`
- [ ] é…ç½®å·²å¯ç”¨ï¼š`/etc/nginx/sites-enabled/tnho-fasteners.com`
- [ ] è¯ä¹¦å­˜åœ¨ï¼š`/etc/letsencrypt/live/tnho-fasteners.com/`
- [ ] nginx -t æµ‹è¯•é€šè¿‡
- [ ] Nginxæ­£åœ¨è¿è¡Œï¼š`systemctl status nginx` æ˜¾ç¤º active (running)
- [ ] HTTPSè®¿é—®æ­£å¸¸ï¼š`curl https://tnho-fasteners.com/health` è¿”å› ok

---

## ğŸ“ å¿«é€Ÿå‘½ä»¤

```bash
# æ£€æŸ¥NginxçŠ¶æ€
sudo systemctl status nginx

# æŸ¥çœ‹Nginxæ—¥å¿—
sudo tail -f /var/log/nginx/error.log

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯Nginx
sudo systemctl restart nginx

# æµ‹è¯•HTTPS
curl https://tnho-fasteners.com/health

# æ£€æŸ¥åº”ç”¨çŠ¶æ€
ps aux | grep "python app.py"
```

---

**è¯ä¹¦æœ‰æ•ˆæœŸ**ï¼š2026-04-13
**é…ç½®æ–‡ä»¶**ï¼š`/etc/nginx/sites-available/tnho-fasteners.com`
**APIåœ°å€**ï¼šhttps://tnho-fasteners.com
**å°ç¨‹åºAppID**ï¼šwx464504ca7e01b3b1

---
